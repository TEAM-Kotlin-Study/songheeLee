# ì†ì „ë“±ğŸ“¸

### **1. ì†ì „ë“± ê¸°ëŠ¥ êµ¬í˜„(Torch.kt)**
CameraManager ê°ì²´ë¥¼ í†µí•´ ëª¨ë“  ì¹´ë©”ë¼ì— ëŒ€í•œ ì •ë³´ë¥¼ ìˆœíšŒí•˜ë©° í•„ìš”í•œ ì •ë³´(ID)ë¥¼ ì°¾ëŠ” í´ë˜ìŠ¤
```kotlin
class Torch(context: Context) { // ìƒì„±ìë¡œ Context ê°ì²´ ë°›ìŒ
    private var cameraId: String? = null

    // getSystemService() ë©”ì„œë“œëŠ” ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œì—ì„œ ì œê³µí•˜ëŠ” ê°ì¢… ì„œë¹„ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ë§¤ë‹ˆì € í´ë˜ìŠ¤ ìƒì„±
    // Objectí˜•ì„ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— as ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ CameraServiceí˜•ìœ¼ë¡œ í˜•ë³€í™˜
    private val cameraManager = context.getSystemService(Context.CAMERA_SERVICE) as CameraManagerv

    init {
        cameraId = getCameraId()
    }

    fun flashOn(){
        cameraId?.let {
            cameraManager.setTorchMode(it, true)
        }
    }

    fun flashOff(){
        cameraId?.let {
            cameraManager.setTorchMode(it, false)
        }
    }

    private fun getCameraId(): String? {
        val cameraIds = cameraManager.cameraIdList
        for(id in cameraIds){
            val info = cameraManager.getCameraCharacteristics(id)
            val flashAvailable = info.get(CameraCharacteristics.LENS_FACING)
            val lensFacing = info.get(CameraCharacteristics.LENS_FACING)

            if(flashAvailable != null && lensFacing != null && lensFacing == CameraCharacteristics.LENS_FACING_BACK)
                return id
        }

        return null
    }
}
```

#
### **2. ì•¡í‹°ë¹„í‹°ì—ì„œ ì†ì „ë“± ê¸°ëŠ¥ ì‚¬ìš©(MainActivity.ktì˜ onCreatë©”ì„œë“œ)**
```kotlin
val torch = Torch(this)
binding.flashSwitch.setOnCheckedChangeListener{_, isChecked ->
    if(isChecked){
        torch.flashOn()
    } else {
        torch.flashOff()
    }
 }
```

#
### **3. ì„œë¹„ìŠ¤ì—ì„œ ì†ì „ë“± ê¸°ëŠ¥ ì‚¬ìš©(TorchService.kt)**
ì„œë¹„ìŠ¤ëŠ” startService()ì— ì˜í•´ í˜¸ì¶œë˜ì–´ onCreate(), onStartCommand() ì½œë°± ë©”ì„œë“œë¥¼ ì‹¤í–‰
```kotlin
class TorchService : Service() {    // Service í´ë˜ìŠ¤ ìƒì†ë°›ìŒ
    private val torch: Torch by lazy {  // torch ê°ì²´ë¥¼ ì²˜ìŒ ì‚¬ìš©í•  ë•Œ ì´ˆê¸°í™” ë¨
        Torch(this)
    }

    // ì™¸ë¶€ì—ì„œ startService() ë©”ì„œë“œë¡œ TorchService ë¥¼ í˜¸ì¶œí•˜ë©´ í•´ë‹¹ ì½œë°± ë©”ì„œë“œê°€ í˜¸ì¶œ
    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        when(intent?.action){
            "on"->{
                torch.flashOn()
            }
            "off"->{
                torch.flashOff()
            }
        }

        // ë¦¬í„´ê°’ì— ë”°ë¼ ì‹œìŠ¤í…œì´ ê°•ì œ ì¢…ë£Œ ë‹¹í•˜ë©´ ì–´ë–»ê²Œ í• ì§€ë¥¼ ê²°ì •
        return super.onStartCommand(intent, flags, startId)
    }

    override fun onBind(intent: Intent): IBinder {
        TODO("Return the communication channel to the service.")
    }
}
```